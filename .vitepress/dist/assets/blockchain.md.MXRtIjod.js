import{d as $,C as i,c as x,o as f,G as t,w as e,j as d,t as S,_ as D,p as C,b as N,a as B,ai as O,F as V,B as F}from"./framework-ChYd473w.js";import{C as I}from"./index-DC2tN1g-.js";import{a as g}from"./index-C2biAZbU.js";import"./commonjsHelpers-C4iS2aBk.js";import"./InfoCircleFilled-CIk9b8H8.js";const P={class:"chain-block-card"},j={class:"title-value"},J=$({__name:"block-card",props:{block:{}},setup(y){return(n,a)=>{const c=i("a-input-number"),l=i("a-form-item"),b=i("a-textarea"),p=i("a-input"),v=i("a-form"),u=i("a-card");return f(),x("div",P,[t(u,{class:"r-card"},{title:e(()=>[a[5]||(a[5]=d("span",{class:"title-label"},"区块 ",-1)),d("span",j,S(n.block.height),1)]),default:e(()=>[t(v,{labelCol:{span:3},wrapperCol:{span:21},class:"r-form"},{default:e(()=>[t(l,{label:"高度"},{default:e(()=>[t(c,{disabled:"",value:n.block.height,"onUpdate:value":a[0]||(a[0]=s=>n.block.height=s),style:{width:"100%"}},{addonBefore:e(()=>a[6]||(a[6]=[d("span",null,"#",-1)])),_:1},8,["value"])]),_:1}),t(l,{label:"随机数"},{default:e(()=>[t(c,{disabled:"",value:n.block.nonce,"onUpdate:value":a[1]||(a[1]=s=>n.block.nonce=s),min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),t(l,{label:"数据"},{default:e(()=>[t(b,{disabled:"",rows:6,value:n.block.data,"onUpdate:value":a[2]||(a[2]=s=>n.block.data=s),class:"text-area"},null,8,["value"])]),_:1}),t(l,{label:"前指针"},{default:e(()=>[t(p,{disabled:"",value:n.block.previous,"onUpdate:value":a[3]||(a[3]=s=>n.block.previous=s),class:"hash-input"},null,8,["value"])]),_:1}),t(l,{label:"哈希"},{default:e(()=>[t(p,{disabled:"",value:n.block.hash,"onUpdate:value":a[4]||(a[4]=s=>n.block.hash=s),class:"hash-input"},null,8,["value"])]),_:1})]),_:1})]),_:1})])}}}),T=D(J,[["__scopeId","data-v-3b1db894"]]),A=$({__name:"x-data",setup(y,{expose:n,emit:a}){const c=C(""),l=a,b=()=>{c.value="",p()},p=()=>l("fetch-data",c.value);return n({reset:b}),(v,u)=>{const s=i("a-button"),w=i("a-textarea"),r=i("a-card");return f(),N(r,{class:"chain-r-card"},{title:e(()=>u[1]||(u[1]=[d("span",{class:"card-title"},"数据",-1)])),extra:e(()=>[t(s,{onClick:b,class:"yellow-btn"},{default:e(()=>u[2]||(u[2]=[B("重置")])),_:1})]),default:e(()=>[t(w,{rows:8,value:c.value,"onUpdate:value":u[0]||(u[0]=o=>c.value=o),onChange:p,placeholder:"请输入数据!",class:"text-area"},null,8,["value"])]),_:1})}}}),E=D(A,[["__scopeId","data-v-c021757b"]]),G={class:"chain-page"},H={class:"chain-layout"},L={class:"chain-input"},W={class:"chain-blocks"},X={class:"chain-card-box"},q=5e5,z=4,K=$({__name:"index",setup(y){const n=C(),a=C(!1),c=C(""),l=O([p()]),b="0".repeat(z);function p(){return{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0".repeat(64),hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}}const v=async()=>{if(!c.value.trim()){g.warning("请输入有效的数据后再挖矿");return}a.value=!0,await new Promise(_=>setTimeout(_,1e3));const r=l[l.length-1],o=u(r,c.value);o?(l.push(o),g.success(`成功挖到区块 #${o.height}`)):g.warning("未找到符合条件的区块，请调整数据后重试"),a.value=!1},u=(r,o)=>{const _=r.height+1,h=r.hash;for(let m=0;m<=q;m++){const k=`${_}${m}${o}${h}`,U=I.SHA256(k).toString();if(U.startsWith(b))return{height:_,nonce:m,data:o,previous:h,hash:U}}return null},s=()=>{var r;l.splice(0,l.length,p()),c.value="",(r=n.value)==null||r.reset(),g.info("区块链已重置")},w=r=>{c.value=r};return(r,o)=>{const _=i("a-button"),h=i("a-card"),m=i("ClientOnly");return f(),x("div",G,[t(m,null,{default:e(()=>[d("div",H,[d("div",L,[t(E,{ref_key:"xData",ref:n,onFetchData:w},null,512)]),d("div",W,[t(h,{class:"chain-card"},{title:e(()=>o[0]||(o[0]=[d("span",{class:"chain-title"},"公链",-1)])),extra:e(()=>[t(_,{plain:"",onClick:v,loading:a.value,danger:""},{default:e(()=>o[1]||(o[1]=[B("⛏️ 挖矿")])),_:1},8,["loading"]),o[3]||(o[3]=d("span",null,"  ",-1)),t(_,{plain:"",onClick:s},{default:e(()=>o[2]||(o[2]=[B("重置")])),_:1})]),default:e(()=>[d("div",X,[(f(!0),x(V,null,F(l,k=>(f(),N(T,{block:k,key:k.height,class:"chain-block"},null,8,["block"]))),128))])]),_:1})])])]),_:1})])}}}),ta=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"page"},"headers":[],"relativePath":"blockchain.md","filePath":"blockchain.md"}'),M={name:"blockchain.md"},ea=Object.assign(M,{setup(y){return(n,a)=>(f(),x("div",null,[t(K)]))}});export{ta as __pageData,ea as default};
