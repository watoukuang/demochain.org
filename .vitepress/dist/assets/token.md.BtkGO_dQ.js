import{d as O,C as n,b as U,o as y,w as a,G as e,j as g,c as N,F as L,B as M,p as x,ai as V,a as X,t as R}from"./framework-DHEgYJ3J.js";import{C as W}from"./index-DC2tN1g-.js";import{a as H}from"./index-vg9ljpQ4.js";import"./commonjsHelpers-C4iS2aBk.js";import"./InfoCircleFilled-CIk9b8H8.js";const K={class:"rows"},Q=O({__name:"block-card",props:{block:{}},setup(G){const v={emptyText:"暂无转账记录!"},h=[{title:"fm",dataIndex:"fm",key:"fm"},{title:"to",dataIndex:"to",key:"to"},{title:"amt",dataIndex:"amt",key:"amt"}];return(c,i)=>{const w=n("a-input-number"),m=n("a-form-item"),u=n("a-table"),T=n("a-textarea"),B=n("a-form"),z=n("a-card");return y(),U(z,{class:"token block-card-container"},{title:a(()=>i[4]||(i[4]=[g("span",{style:{"font-size":"18px",color:"#fab301"}},"区块",-1)])),default:a(()=>[e(B,{labelCol:{span:4},wrapperCol:{span:20},class:"r-form"},{default:a(()=>[e(m,{label:"高度"},{default:a(()=>[e(w,{value:c.block.height,"onUpdate:value":i[0]||(i[0]=f=>c.block.height=f),style:{width:"100%"},min:"1"},{addonBefore:a(()=>i[5]||(i[5]=[g("span",null,"#",-1)])),_:1},8,["value"])]),_:1}),e(m,{label:"随机数"},{default:a(()=>[e(w,{value:c.block.nonce,"onUpdate:value":i[1]||(i[1]=f=>c.block.nonce=f),min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),e(m,{label:"TX",class:"tx"},{default:a(()=>[g("div",K,[e(u,{bordered:"",columns:h,"data-source":c.block.txs,locale:v,size:"small",pagination:!1},null,8,["data-source"])])]),_:1}),e(m,{label:"前指针"},{default:a(()=>[e(T,{row:2,disabled:"",value:c.block.previous,"onUpdate:value":i[2]||(i[2]=f=>c.block.previous=f),style:{"font-size":"12px"}},null,8,["value"])]),_:1}),e(m,{label:"哈希"},{default:a(()=>[e(T,{row:2,disabled:"",value:c.block.hash,"onUpdate:value":i[3]||(i[3]=f=>c.block.hash=f),style:{"font-size":"12px"}},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),Y={class:"token blockchain-container"},J=O({__name:"block-chain",props:{blocks:{}},setup(G){return(v,h)=>(y(),N("div",Y,[(y(!0),N(L,null,M(v.blocks,c=>(y(),U(Q,{key:c.height,block:c,class:"block-card"},null,8,["block"]))),128))]))}}),Z={class:"rows"},tt=O({__name:"machine-cfg",setup(G,{expose:v,emit:h}){const c=[{value:"1",label:"4核GPU"},{value:"2",label:"8核GPU"},{value:"3",label:"16核GPU"}],i=x("1"),w=x("2"),m=x("3"),u=V([]),T={emptyText:"暂无转账记录!"},B=()=>{i.value="1",w.value="2",m.value="3"},z=[{title:"fm",dataIndex:"fm",key:"fm"},{title:"to",dataIndex:"to",key:"to"},{title:"amt",dataIndex:"amt",key:"amt"}],f=x(!1),E=()=>f.value=!0,j=h,I=C=>{let l="";C==="a"&&(l=i.value),C==="b"&&(l=w.value),C==="c"&&(l=m.value),j("fetch-gpu",{machine:C,gpu:l})},_=x({fm:"",to:"",amt:0}),S=()=>{u.push(_.value),j("fetch-tx",u),P(),f.value=!1},A=()=>(f.value=!1,P()),P=()=>{_.value={fm:"",to:"",amt:0}};return v({reset:B}),(C,l)=>{const q=n("a-button"),F=n("a-select"),s=n("a-form-item"),t=n("a-col"),o=n("a-row"),p=n("a-table"),b=n("a-form"),k=n("a-input"),r=n("a-input-number"),D=n("a-modal"),$=n("a-card");return y(),U($,{class:"token pool-cfg-card"},{title:a(()=>l[10]||(l[10]=[g("span",{class:"title"},"配置",-1)])),extra:a(()=>[e(q,{plain:"",onClick:E,danger:""},{default:a(()=>l[11]||(l[11]=[X("转账")])),_:1})]),default:a(()=>[e(b,{ref:"formRef"},{default:a(()=>[e(o,{justify:"space-between"},{default:a(()=>[e(t,{span:7},{default:a(()=>[e(s,{label:"电脑A"},{default:a(()=>[e(F,{value:i.value,"onUpdate:value":l[0]||(l[0]=d=>i.value=d),options:c,onChange:l[1]||(l[1]=()=>I("a"))},null,8,["value"])]),_:1})]),_:1}),e(t,{span:7},{default:a(()=>[e(s,{label:"电脑B"},{default:a(()=>[e(F,{value:w.value,"onUpdate:value":l[2]||(l[2]=d=>w.value=d),options:c,onChange:l[3]||(l[3]=()=>I("b"))},null,8,["value"])]),_:1})]),_:1}),e(t,{span:7},{default:a(()=>[e(s,{label:"电脑C"},{default:a(()=>[e(F,{value:m.value,"onUpdate:value":l[4]||(l[4]=d=>m.value=d),options:c,onChange:l[5]||(l[5]=()=>I("c"))},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(s,{label:"TX",class:"tx"},{default:a(()=>[g("div",Z,[e(p,{bordered:"",columns:z,"data-source":u,locale:T,size:"small",pagination:!1},null,8,["data-source"])])]),_:1})]),_:1},512),e(D,{ref:"xModal",open:f.value,"onUpdate:open":l[9]||(l[9]=d=>f.value=d),title:"开始转账","ok-text":"确认","cancel-text":"取消",width:"400px",closeIcon:!0,zIndex:"100",onOk:S,onCancel:A},{default:a(()=>[e(b,{labelCol:{span:5},wrapperCol:{span:19},model:_.value},{default:a(()=>[e(s,{label:"fm",name:"fm",rules:[{required:!0,message:"please input from address!"}]},{default:a(()=>[e(k,{value:_.value.fm,"onUpdate:value":l[6]||(l[6]=d=>_.value.fm=d),placeholder:"please input from address!"},null,8,["value"])]),_:1}),e(s,{label:"to",name:"to",rules:[{required:!0,message:"please input to address!"}]},{default:a(()=>[e(k,{value:_.value.to,"onUpdate:value":l[7]||(l[7]=d=>_.value.to=d),placeholder:"please input to address!"},null,8,["value"])]),_:1}),e(s,{label:"amt",name:"amt",rules:[{required:!0,message:"please input amount!"}]},{default:a(()=>[e(r,{addonAfter:"Bells",value:_.value.amt,"onUpdate:value":l[8]||(l[8]=d=>_.value.amt=d),style:{width:"100%"},min:"0",placeholder:"please input amount!"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])]),_:1})}}}),et={class:"meta"},at=O({__name:"computer",props:{items:{}},setup(G){return(v,h)=>{const c=n("a-list-item-meta"),i=n("a-steps"),w=n("a-list-item"),m=n("a-list"),u=n("a-card");return y(),U(u,{class:"token workflow-card"},{title:a(()=>h[0]||(h[0]=[g("span",{style:{"font-size":"18px",color:"#f14545"}},"电脑",-1)])),default:a(()=>[e(m,{class:"list"},{default:a(()=>[(y(!0),N(L,null,M(v.items,(T,B)=>(y(),U(w,{key:B,class:"list-item"},{default:a(()=>[e(c,null,{avatar:a(()=>[g("span",et,R(T.title),1)]),_:2},1024),(y(),U(i,{items:T.steps,class:"steps",key:B},null,8,["items"]))]),_:2},1024))),128))]),_:1})]),_:1})}}}),st={class:"token-container"},lt=5e5,nt=O({__name:"index",setup(G){const v=x(!1),h=V([]),c=x("1"),i=x("2"),w=x("3"),m=V([{title:"电脑A",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑B",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑C",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]}]),u=V([{height:1,nonce:49691,txs:[],previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}]);let B="0".repeat(4);const z=async()=>{v.value=!0,H.info("模拟挖矿开始运行......"),await f();const s=u.length+1;try{await Promise.all([E(s).then(()=>console.error("挖矿失败.....")),j(s).then(()=>console.error("挖矿失败.....")),I(s).then(()=>console.error("挖矿失败....."))])}catch(t){console.error("挖矿过程中出现未知错误:",t)}finally{v.value=!1,H.success("模拟挖矿结束......")}},f=async()=>{m.forEach(s=>{s.steps=[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]})},E=async s=>{let t=m[0].steps;await _(t);let o=u[u.length-1],p=await S(o,t);p=await A(p,c.value,t),await P(p,s,t)&&await C(t)},j=async s=>{let t=m[1].steps;await _(t);let o=u[u.length-1],p=await S(o,t);p=await A(p,i.value,t),await P(p,s,t)&&await C(t)},I=async s=>{let t=m[2].steps;await _(t);let o=u[u.length-1],p=await S(o,t);p=await A(p,w.value,t),await P(p,s,t)&&await C(t)},_=async s=>{await new Promise(t=>setTimeout(t,2e3)),s[0].status="process",await new Promise(t=>setTimeout(t,2e3)),s[0].status="finish"},S=async(s,t)=>{await new Promise(k=>setTimeout(k,2e3)),t[1].status="process";let{height:o,hash:p}=s,b={height:o+1,nonce:0,txs:h,hash:"",previous:p};return await new Promise(k=>setTimeout(k,2e3)),t[1].status="finish",b},A=async(s,t,o)=>{await new Promise(r=>setTimeout(r,2e3)),o[2].status="process",t==="1"&&await new Promise(r=>setTimeout(r,9e3)),t==="2"&&await new Promise(r=>setTimeout(r,6e3)),t==="3"&&await new Promise(r=>setTimeout(r,3e3));const{height:p,txs:b}=s;let k=b.map(r=>`${r.fm},${r.to},${r.amt}`).join(";");for(let r=0;r<lt;r++){const D=`${p}${r}${k}`,$=W.SHA256(D).toString();if($.startsWith(B))return s.nonce=r,s.hash=$,await new Promise(d=>setTimeout(d,2e3)),o[2].status="finish",s}return null},P=async(s,t,o)=>(o[3].status="process",await new Promise(p=>setTimeout(p,2e3)),u.length===t?(o[3].status="error",!1):(s!==null&&u.push(s),o[3].status="finish",!0)),C=async s=>{await new Promise(t=>setTimeout(t,2e3)),s[4].status="finish"},l=s=>{const{machine:t,gpu:o}=s;t==="a"&&(c.value=o),t==="b"&&(i.value=o),t==="c"&&(w.value=o)},q=x(),F=()=>{u.splice(0,u.length,{height:1,nonce:49691,txs:[],previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}),q.value.reset(),f()};return(s,t)=>{const o=n("a-col"),p=n("a-row"),b=n("a-button"),k=n("a-list-item-meta"),r=n("a-list-item"),D=n("a-list"),$=n("a-card"),d=n("ClientOnly");return y(),N("div",st,[e(d,null,{default:a(()=>[e(p,{gutter:[16,16],wrap:!0,class:"workspace-row"},{default:a(()=>[e(o,{xs:24,md:9},{default:a(()=>[e(tt,{class:"x-data",ref_key:"poolCfg",ref:q,onFetchGpu:l,onFetchData:s.changeData},null,8,["onFetchData"])]),_:1}),e(o,{xs:24,md:15},{default:a(()=>[e(at,{items:m},null,8,["items"])]),_:1})]),_:1}),e($,{class:"blockchain-card"},{title:a(()=>t[0]||(t[0]=[g("span",{class:"card-title"},"公链",-1)])),extra:a(()=>[e(b,{plain:"",onClick:z,loading:v.value,danger:""},{default:a(()=>t[1]||(t[1]=[X("⛏️ 挖矿")])),_:1},8,["loading"]),t[3]||(t[3]=g("span",null,"  ",-1)),e(b,{plain:"",onClick:F},{default:a(()=>t[2]||(t[2]=[X("重置")])),_:1})]),default:a(()=>[e(D,{class:"list"},{default:a(()=>[e(r,{class:"list-item"},{default:a(()=>[e(k,null,{avatar:a(()=>t[4]||(t[4]=[g("span",{class:"meta"},"电脑A",-1)])),_:1}),e(J,{blocks:u,ref:"aBlockChain"},null,8,["blocks"])]),_:1}),e(r,{class:"list-item"},{default:a(()=>[e(k,null,{avatar:a(()=>t[5]||(t[5]=[g("span",{class:"meta"},"电脑B",-1)])),_:1}),e(J,{blocks:u,ref:"bBlockChain"},null,8,["blocks"])]),_:1}),e(r,{class:"list-item"},{default:a(()=>[e(k,null,{avatar:a(()=>t[6]||(t[6]=[g("span",{class:"meta"},"电脑C",-1)])),_:1}),e(J,{blocks:u,ref:"cBlockChain"},null,8,["blocks"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),mt=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"page"},"headers":[],"relativePath":"token.md","filePath":"token.md"}'),ot={name:"token.md"},dt=Object.assign(ot,{setup(G){return(v,h)=>(y(),N("div",null,[e(nt)]))}});export{mt as __pageData,dt as default};
