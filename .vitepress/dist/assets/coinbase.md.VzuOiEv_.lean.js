import{d as N,C as o,b as A,o as h,w as a,G as t,j as f,c as D,F as Q,B as Y,p as v,ai as V,a as R,t as E}from"./framework-ChYd473w.js";import{C as Z}from"./index-DC2tN1g-.js";import{a as K}from"./index-C2biAZbU.js";import"./commonjsHelpers-C4iS2aBk.js";import"./InfoCircleFilled-CIk9b8H8.js";const tt={class:"rows"},et={class:"rows"},at=N({__name:"block-card",props:{block:{}},setup(F){const w={emptyText:"暂无转账记录!"},C=[{title:"fm",dataIndex:"fm",key:"fm"},{title:"to",dataIndex:"to",key:"to"},{title:"amt",dataIndex:"amt",key:"amt"}];return(u,r)=>{const b=o("a-input-number"),_=o("a-form-item"),d=o("a-input"),p=o("a-input-group"),U=o("a-table"),I=o("a-textarea"),T=o("a-form"),g=o("a-card");return h(),A(g,{class:"cbase block-card-container"},{title:a(()=>r[6]||(r[6]=[f("span",{style:{"font-size":"18px",color:"#fab301"}},"区块",-1)])),default:a(()=>[t(T,{labelCol:{span:4},wrapperCol:{span:20},class:"r-form"},{default:a(()=>[t(_,{label:"高度"},{default:a(()=>[t(b,{value:u.block.height,"onUpdate:value":r[0]||(r[0]=m=>u.block.height=m),style:{width:"100%"},min:"1"},{addonBefore:a(()=>r[7]||(r[7]=[f("span",null,"#",-1)])),_:1},8,["value"])]),_:1}),t(_,{label:"随机数"},{default:a(()=>[t(b,{value:u.block.nonce,"onUpdate:value":r[1]||(r[1]=m=>u.block.nonce=m),min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),t(_,{label:"币基"},{default:a(()=>[f("div",tt,[t(p,{compact:""},{default:a(()=>[t(d,{addonBefore:"Bells",value:u.block.award,"onUpdate:value":r[2]||(r[2]=m=>u.block.award=m),style:{width:"50%"}},null,8,["value"]),t(d,{style:{width:"15%"},value:"->",disabled:""}),t(d,{style:{width:"30%"},value:u.block.miner,"onUpdate:value":r[3]||(r[3]=m=>u.block.miner=m)},null,8,["value"])]),_:1})])]),_:1}),t(_,{label:"TX",class:"tx"},{default:a(()=>[f("div",et,[t(U,{bordered:"",columns:C,"data-source":u.block.txs,locale:w,size:"small",pagination:!1},null,8,["data-source"])])]),_:1}),t(_,{label:"前指针"},{default:a(()=>[t(I,{row:2,disabled:"",value:u.block.previous,"onUpdate:value":r[4]||(r[4]=m=>u.block.previous=m),style:{"font-size":"12px"}},null,8,["value"])]),_:1}),t(_,{label:"哈希"},{default:a(()=>[t(I,{row:2,disabled:"",value:u.block.hash,"onUpdate:value":r[5]||(r[5]=m=>u.block.hash=m),style:{"font-size":"12px"}},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),lt={class:"blockchain-container"},M=N({__name:"block-chain",props:{blocks:{}},setup(F){return(w,C)=>(h(),D("div",lt,[(h(!0),D(Q,null,Y(w.blocks,u=>(h(),A(at,{key:u.height,block:u,class:"block-card"},null,8,["block"]))),128))]))}}),st={class:"rows"},nt=N({__name:"machine-cfg",setup(F,{expose:w,emit:C}){const u=[{value:"1",label:"4核GPU"},{value:"2",label:"8核GPU"},{value:"3",label:"16核GPU"}],r=v(50),b=v("1"),_=v("2"),d=v("3"),p=V([]),U={emptyText:"暂无转账记录!"},I=()=>{b.value="1",_.value="2",d.value="3"},T=[{title:"fm",dataIndex:"fm",key:"fm"},{title:"to",dataIndex:"to",key:"to"},{title:"amt",dataIndex:"amt",key:"amt"}],g=v(!1),m=()=>g.value=!0,O=C,$=B=>{let s="";B==="a"&&(s=b.value),B==="b"&&(s=_.value),B==="c"&&(s=d.value),O("fetch-gpu",{machine:B,gpu:s})},k=v({fm:"",to:"",amt:0}),J=()=>{p.push(k.value),O("fetch-tx",p),S(),g.value=!1},X=()=>(g.value=!1,S()),S=()=>{k.value={fm:"",to:"",amt:0}};return w({reset:I}),(B,s)=>{const j=o("a-button"),G=o("a-select"),x=o("a-form-item"),z=o("a-col"),W=o("a-row"),n=o("a-input-number"),e=o("a-table"),c=o("a-form"),i=o("a-input"),y=o("a-modal"),P=o("a-card");return h(),A(P,{class:"pool-cfg-card"},{title:a(()=>s[12]||(s[12]=[f("span",{class:"title"},"配置",-1)])),extra:a(()=>[t(j,{plain:"",onClick:m,danger:""},{default:a(()=>s[13]||(s[13]=[R("转账")])),_:1})]),default:a(()=>[t(c,{ref:"formRef"},{default:a(()=>[t(W,{justify:"space-between"},{default:a(()=>[t(z,{span:7},{default:a(()=>[t(x,{label:"电脑A"},{default:a(()=>[t(G,{value:b.value,"onUpdate:value":s[0]||(s[0]=l=>b.value=l),options:u,onChange:s[1]||(s[1]=()=>$("a"))},null,8,["value"])]),_:1})]),_:1}),t(z,{span:7},{default:a(()=>[t(x,{label:"电脑B"},{default:a(()=>[t(G,{value:_.value,"onUpdate:value":s[2]||(s[2]=l=>_.value=l),options:u,onChange:s[3]||(s[3]=()=>$("b"))},null,8,["value"])]),_:1})]),_:1}),t(z,{span:7},{default:a(()=>[t(x,{label:"电脑C"},{default:a(()=>[t(G,{value:d.value,"onUpdate:value":s[4]||(s[4]=l=>d.value=l),options:u,onChange:s[5]||(s[5]=()=>$("c"))},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(W,{justify:"space-between"},{default:a(()=>[t(z,{span:11},{default:a(()=>[t(x,{label:"奖励"},{default:a(()=>[t(n,{addonAfter:"Bells",value:r.value,"onUpdate:value":s[6]||(s[6]=l=>r.value=l),onChange:s[7]||(s[7]=()=>$("a")),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(x,{label:"TX",class:"tx"},{default:a(()=>[f("div",st,[t(e,{bordered:"",columns:T,"data-source":p,locale:U,size:"small",pagination:!1},null,8,["data-source"])])]),_:1})]),_:1},512),t(y,{ref:"xModal",open:g.value,"onUpdate:open":s[11]||(s[11]=l=>g.value=l),title:"开始转账","ok-text":"确认","cancel-text":"取消",width:"400px",closeIcon:!0,zIndex:"100",onOk:J,onCancel:X},{default:a(()=>[t(c,{labelCol:{span:5},wrapperCol:{span:19},model:k.value},{default:a(()=>[t(x,{label:"fm",name:"fm",rules:[{required:!0,message:"please input from address!"}]},{default:a(()=>[t(i,{value:k.value.fm,"onUpdate:value":s[8]||(s[8]=l=>k.value.fm=l),placeholder:"please input from address!"},null,8,["value"])]),_:1}),t(x,{label:"to",name:"to",rules:[{required:!0,message:"please input to address!"}]},{default:a(()=>[t(i,{value:k.value.to,"onUpdate:value":s[9]||(s[9]=l=>k.value.to=l),placeholder:"please input to address!"},null,8,["value"])]),_:1}),t(x,{label:"amt",name:"amt",rules:[{required:!0,message:"please input amount!"}]},{default:a(()=>[t(n,{addonAfter:"Bells",value:k.value.amt,"onUpdate:value":s[10]||(s[10]=l=>k.value.amt=l),style:{width:"100%"},min:"0",placeholder:"please input amount!"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])]),_:1})}}}),ot={class:"meta"},it=N({__name:"computer",props:{items:{}},setup(F){return(w,C)=>{const u=o("a-list-item-meta"),r=o("a-steps"),b=o("a-list-item"),_=o("a-list"),d=o("a-card");return h(),A(d,{class:"computer workflow-card"},{title:a(()=>C[0]||(C[0]=[f("span",{style:{"font-size":"18px",color:"#f14545"}},"电脑",-1)])),default:a(()=>[t(_,{class:"list"},{default:a(()=>[(h(!0),D(Q,null,Y(w.items,(p,U)=>(h(),A(b,{key:U,class:"list-item"},{default:a(()=>[t(u,null,{avatar:a(()=>[f("span",ot,E(p.title),1)]),_:2},1024),(h(),A(r,{items:p.steps,class:"steps",key:U},null,8,["items"]))]),_:2},1024))),128))]),_:1})]),_:1})}}}),ut={class:"cbase-container"},rt={class:"wallet-info awallet"},ct={class:"wallet-info bwallet"},pt={class:"wallet-info cwallet"},mt=5e5,dt=N({__name:"index",setup(F){const w=v(!1),C=V([]),u=v("1"),r=v("2"),b=v("3"),_=v(50),d=V([{title:"电脑A",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑B",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]},{title:"电脑C",steps:[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]}]),p=V([{height:1,nonce:49691,award:50,txs:[],miner:"Bridge",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}]);let I="0".repeat(4);const T=v(0),g=v(0),m=v(0),O=async()=>{w.value=!0,K.info("模拟挖矿开始运行......"),await $();const n=p.length+1;try{await Promise.all([k(n).then(()=>console.error("挖矿失败.....")),J(n).then(()=>console.error("挖矿失败.....")),X(n).then(()=>console.error("挖矿失败....."))])}catch(e){console.error("挖矿过程中出现未知错误:",e)}finally{w.value=!1,K.success("模拟挖矿结束......")}},$=async()=>{d.forEach(n=>{n.steps=[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]})},k=async n=>{let e=d[0].steps;await S(e);let c=p[p.length-1],i=await B(c,e,"Aminer");i=await s(i,u.value,e),await j(i,n,e)&&await G(e)},J=async n=>{let e=d[1].steps;await S(e);let c=p[p.length-1],i=await B(c,e,"Bminer");i=await s(i,r.value,e),await j(i,n,e)&&await G(e)},X=async n=>{let e=d[2].steps;await S(e);let c=p[p.length-1],i=await B(c,e,"Cminer");i=await s(i,b.value,e),await j(i,n,e)&&await G(e)},S=async n=>{await new Promise(e=>setTimeout(e,2e3)),n[0].status="process",await new Promise(e=>setTimeout(e,2e3)),n[0].status="finish"},B=async(n,e,c)=>{await new Promise(l=>setTimeout(l,2e3)),e[1].status="process";let{height:i,hash:y}=n,P={height:i+1,nonce:0,txs:C,hash:"",previous:y,award:_.value,miner:c};return await new Promise(l=>setTimeout(l,2e3)),e[1].status="finish",P},s=async(n,e,c)=>{await new Promise(l=>setTimeout(l,2e3)),c[2].status="process",e==="1"&&await new Promise(l=>setTimeout(l,9e3)),e==="2"&&await new Promise(l=>setTimeout(l,6e3)),e==="3"&&await new Promise(l=>setTimeout(l,3e3));const{height:i,txs:y}=n;let P=y.map(l=>`${l.fm},${l.to},${l.amt}`).join(";");for(let l=0;l<mt;l++){const H=`${i}${l}${P}`,q=Z.SHA256(H).toString();if(q.startsWith(I))return n.nonce=l,n.hash=q,await new Promise(L=>setTimeout(L,2e3)),c[2].status="finish",n}return null},j=async(n,e,c)=>{if(c[3].status="process",await new Promise(i=>setTimeout(i,2e3)),p.length===e)return c[3].status="error",!1;if(n!==null){p.push(n);let i=n.award;n.miner==="Aminer"&&(T.value=T.value+i),n.miner==="Bminer"&&(g.value=g.value+i),n.miner==="Cminer"&&(m.value=m.value+i)}return c[3].status="finish",!0},G=async n=>{await new Promise(e=>setTimeout(e,2e3)),n[4].status="finish"},x=n=>{const{machine:e,gpu:c}=n;e==="a"&&(u.value=c),e==="b"&&(r.value=c),e==="c"&&(b.value=c)},z=v(),W=()=>{p.splice(0,p.length,{height:1,nonce:49691,award:50,txs:[],miner:"Bridge",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}),z.value.reset(),$()};return(n,e)=>{const c=o("a-col"),i=o("a-row"),y=o("a-button"),P=o("a-list-item-meta"),l=o("a-list-item"),H=o("a-list"),q=o("a-card"),L=o("ClientOnly");return h(),D("div",ut,[t(L,null,{default:a(()=>[t(i,{gutter:[16,16],wrap:!0,class:"workspace-row"},{default:a(()=>[t(c,{xs:24,md:9},{default:a(()=>[t(nt,{class:"x-data",ref_key:"poolCfg",ref:z,onFetchGpu:x,onFetchData:n.changeData},null,8,["onFetchData"])]),_:1}),t(c,{xs:24,md:15},{default:a(()=>[t(it,{items:d},null,8,["items"])]),_:1})]),_:1}),t(q,{class:"blockchain-card"},{title:a(()=>e[0]||(e[0]=[f("span",{class:"card-title"},"公链",-1)])),extra:a(()=>[f("span",rt,"AWallet: "+E(T.value)+" Bells",1),f("span",ct,"BWallet: "+E(g.value)+" Bells",1),f("span",pt,"CWallet: "+E(m.value)+" Bells",1),t(y,{plain:"",onClick:O,loading:w.value,danger:""},{default:a(()=>e[1]||(e[1]=[R("⛏️ 挖矿")])),_:1},8,["loading"]),e[3]||(e[3]=f("span",null,"  ",-1)),t(y,{plain:"",onClick:W},{default:a(()=>e[2]||(e[2]=[R("重置")])),_:1})]),default:a(()=>[t(H,{class:"list"},{default:a(()=>[t(l,{class:"list-item"},{default:a(()=>[t(P,null,{avatar:a(()=>e[4]||(e[4]=[f("span",{class:"meta"},"电脑A",-1)])),_:1}),t(M,{blocks:p,ref:"aBlockChain"},null,8,["blocks"])]),_:1}),t(l,{class:"list-item"},{default:a(()=>[t(P,null,{avatar:a(()=>e[5]||(e[5]=[f("span",{class:"meta"},"电脑B",-1)])),_:1}),t(M,{blocks:p,ref:"bBlockChain"},null,8,["blocks"])]),_:1}),t(l,{class:"list-item"},{default:a(()=>[t(P,null,{avatar:a(()=>e[6]||(e[6]=[f("span",{class:"meta"},"电脑C",-1)])),_:1}),t(M,{blocks:p,ref:"cBlockChain"},null,8,["blocks"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),kt=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"page"},"headers":[],"relativePath":"coinbase.md","filePath":"coinbase.md"}'),ft={name:"coinbase.md"},yt=Object.assign(ft,{setup(F){return(w,C)=>(h(),D("div",null,[t(dt)]))}});export{kt as __pageData,yt as default};
