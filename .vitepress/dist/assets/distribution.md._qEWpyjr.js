import{d as x,C as s,b as B,o as d,w as a,G as t,j as w,_ as L,c as C,F as N,B as F,p as h,t as M,v as R,ai as E,a as I}from"./framework-ChYd473w.js";import{C as q}from"./index-DC2tN1g-.js";import{a as J}from"./index-C2biAZbU.js";import"./commonjsHelpers-C4iS2aBk.js";import"./InfoCircleFilled-CIk9b8H8.js";const z=x({__name:"block-card",props:{block:{}},setup(U){return(l,n)=>{const p=s("a-input-number"),r=s("a-form-item"),_=s("a-textarea"),k=s("a-form"),m=s("a-card");return d(),B(m,{class:"diste block-card-container"},{title:a(()=>n[5]||(n[5]=[w("span",{class:"card-title"},"区块",-1)])),default:a(()=>[t(k,{labelCol:{span:4},wrapperCol:{span:20},class:"r-form"},{default:a(()=>[t(r,{label:"高度"},{default:a(()=>[t(p,{value:l.block.height,"onUpdate:value":n[0]||(n[0]=o=>l.block.height=o),class:"transparent-input",style:{width:"100%"},min:"1"},{addonBefore:a(()=>n[6]||(n[6]=[w("span",null,"#",-1)])),_:1},8,["value"])]),_:1}),t(r,{label:"随机数"},{default:a(()=>[t(p,{value:l.block.nonce,"onUpdate:value":n[1]||(n[1]=o=>l.block.nonce=o),class:"transparent-input",min:"1",max:"500000",style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{label:"数据"},{default:a(()=>[t(_,{rows:4,value:l.block.data,"onUpdate:value":n[2]||(n[2]=o=>l.block.data=o),class:"text-area transparent-input"},null,8,["value"])]),_:1}),t(r,{label:"前指针"},{default:a(()=>[t(_,{class:"hash-input",rows:2,disabled:"",value:l.block.previous,"onUpdate:value":n[3]||(n[3]=o=>l.block.previous=o)},null,8,["value"])]),_:1}),t(r,{label:"哈希"},{default:a(()=>[t(_,{class:"hash-input",rows:2,disabled:"",value:l.block.hash,"onUpdate:value":n[4]||(n[4]=o=>l.block.hash=o)},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),K=L(z,[["__scopeId","data-v-80f93ff3"]]),Q={class:"diste blockchain-container"},X=x({__name:"block-chain",props:{blocks:{}},setup(U){return(l,n)=>(d(),C("div",Q,[(d(!0),C(N,null,F(l.blocks,p=>(d(),B(K,{key:p.height,block:p,class:"block-card"},null,8,["block"]))),128))]))}}),Y=x({__name:"pool-cfg",setup(U,{expose:l,emit:n}){const p=[{value:"1",label:"4核GPU"},{value:"2",label:"8核GPU"},{value:"3",label:"16核GPU"}],r=h(["1","2","3"]),_=h(null),k=()=>{_.value=null,r.value=["1","2","3"]},m=n,o=$=>{const b=r.value[$];m("fetch-gpu",{machine:String.fromCharCode(65+$),gpu:b})},f=()=>m("fetch-data",_.value);return l({reset:k}),($,b)=>{const G=s("a-select"),c=s("a-form-item"),O=s("a-col"),j=s("a-row"),P=s("a-textarea"),A=s("a-form"),i=s("a-card");return d(),B(i,{class:"diste r-card"},{title:a(()=>b[1]||(b[1]=[w("span",{class:"card-title"},"配置",-1)])),default:a(()=>[t(A,null,{default:a(()=>[t(j,{justify:"space-between"},{default:a(()=>[(d(),C(N,null,F(p,(e,v)=>t(O,{key:e.value,span:7},{default:a(()=>[t(c,{label:"电脑"+String.fromCharCode(65+v)},{default:a(()=>[t(G,{value:r.value[v],"onUpdate:value":u=>r.value[v]=u,options:p,onChange:()=>o(v)},null,8,["value","onUpdate:value","onChange"])]),_:2},1032,["label"])]),_:2},1024)),64))]),_:1}),t(c,{label:"数据",style:{"margin-top":"10px"}},{default:a(()=>[t(P,{rows:7,value:_.value,"onUpdate:value":b[0]||(b[0]=e=>_.value=e),onChange:f},null,8,["value"])]),_:1})]),_:1})]),_:1})}}}),Z={class:"meta"},tt=x({__name:"computer",props:{items:{}},setup(U){return(l,n)=>{const p=s("a-list-item-meta"),r=s("a-steps"),_=s("a-list-item"),k=s("a-list"),m=s("a-card");return d(),B(m,{class:"diste workflow-card"},{title:a(()=>n[0]||(n[0]=[w("span",{class:"card-title"},"电脑",-1)])),default:a(()=>[t(k,{class:"list"},{default:a(()=>[(d(!0),C(N,null,F(l.items,(o,f)=>(d(),B(_,{key:f,class:"list-item"},{default:a(()=>[t(p,null,{avatar:a(()=>[w("span",Z,M(o.title),1)]),_:2},1024),(d(),B(r,{items:o.steps,class:"steps",key:f},null,8,["items"]))]),_:2},1024))),128))]),_:1})]),_:1})}}}),at={class:"diste-container"},et={class:"meta"},st="0000",nt=5e5,ot=x({__name:"index",setup(U){const l=h(!1),n=h(""),p=h("1"),r=h("2"),_=h("3"),k=h(!1);R(()=>{k.value=window.innerWidth<768});const m=E([{title:"电脑A",steps:f()},{title:"电脑B",steps:f()},{title:"电脑C",steps:f()}]),o=E([{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}]);function f(){return[{title:"开始",status:"wait"},{title:"打包",status:"wait"},{title:"计算",status:"wait"},{title:"同步",status:"wait"},{title:"结束",status:"wait"}]}const $=async()=>{l.value=!0,J.info("模拟挖矿开始运行......"),await b();const i=o.length+1;try{await Promise.all([G(0,p.value,i),G(1,r.value,i),G(2,_.value,i)])}catch(e){console.error("挖矿过程中出现错误:",e)}finally{l.value=!1,J.success("模拟挖矿结束......")}},b=async()=>{m.forEach((i,e)=>{i.steps=f()})},G=async(i,e,v)=>{const u=m[i].steps;await c(2e3),u[0].status="process",await c(2e3),u[0].status="finish",await c(2e3),u[1].status="process";const S=o[o.length-1];let g={height:S.height+1,nonce:0,data:n.value,previous:S.hash,hash:""};await c(2e3),u[1].status="finish",await c(2e3),u[2].status="process",e==="1"&&await c(9e3),e==="2"&&await c(6e3),e==="3"&&await c(3e3);for(let y=0;y<nt;y++){const T=`${g.height}${y}${g.data}`,D=q.SHA256(T).toString();if(D.startsWith(st)){g.nonce=y,g.hash=D;break}}return await c(2e3),u[2].status="finish",await c(2e3),u[3].status="process",o.length===v?(u[3].status="error",!1):(o.push(g),u[3].status="finish",await c(2e3),u[4].status="finish",!0)},c=i=>new Promise(e=>setTimeout(e,i)),O=({machine:i,gpu:e})=>{i==="a"&&(p.value=e),i==="b"&&(r.value=e),i==="c"&&(_.value=e)},j=i=>n.value=i,P=h(),A=()=>{o.splice(0,o.length,{height:1,nonce:49691,data:"第一笔交易记录数据",previous:"0000000000000000000000000000000000000000000000000000000000000000",hash:"0000b61c8bb61a6faa7c46e4872623b6e4caac5a0ae3a3b416849b216d0d62f6"}),P.value.reset(),b()};return(i,e)=>{const v=s("a-col"),u=s("a-row"),S=s("a-button"),g=s("a-list-item-meta"),y=s("a-list-item"),T=s("a-list"),D=s("a-card"),W=s("ClientOnly");return d(),C("div",at,[t(W,null,{default:a(()=>[t(u,{gutter:[16,16],wrap:!0,class:"workspace-row"},{default:a(()=>[t(v,{xs:24,md:9},{default:a(()=>[t(Y,{class:"x-data",ref_key:"poolCfg",ref:P,onFetchGpu:O,onFetchData:j},null,512)]),_:1}),t(v,{xs:24,md:15},{default:a(()=>[t(tt,{items:m},null,8,["items"])]),_:1})]),_:1}),t(D,{class:"blockchain-card"},{title:a(()=>e[0]||(e[0]=[w("span",{class:"card-title"},"公链",-1)])),extra:a(()=>[t(S,{plain:"",onClick:$,loading:l.value,danger:""},{default:a(()=>e[1]||(e[1]=[I("⛏️ 挖矿")])),_:1},8,["loading"]),e[3]||(e[3]=w("span",null,"  ",-1)),t(S,{plain:"",onClick:A},{default:a(()=>e[2]||(e[2]=[I("重置")])),_:1})]),default:a(()=>[t(T,{class:"list"},{default:a(()=>[(d(),C(N,null,F(["电脑A","电脑B","电脑C"],(V,H)=>t(y,{class:"list-item",key:H},{default:a(()=>[t(g,null,{avatar:a(()=>[w("span",et,M(V),1)]),_:2},1024),t(X,{blocks:o,ref_for:!0,ref:`${V.toLowerCase()}BlockChain`},null,8,["blocks"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})])}}}),lt=L(ot,[["__scopeId","data-v-385dba9f"]]),dt=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"page"},"headers":[],"relativePath":"distribution.md","filePath":"distribution.md"}'),it={name:"distribution.md"},mt=Object.assign(it,{setup(U){return(l,n)=>(d(),C("div",null,[t(lt)]))}});export{dt as __pageData,mt as default};
